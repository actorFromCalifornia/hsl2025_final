rtabmap:
  ros__parameters:
    # Common parameters - все как строки
    frame_id: "base_link"
    odom_frame_id: "odom"
    map_frame_id: "map"

    # RGBG configuration
    subscribe_rgb: false
    subscribe_depth: false
    subscribe_rgbd: false

    # LiDAR configuration
    subscribe_scan: false
    subscribe_scan_cloud: true
    scan_topic: "/livox/lidar"
    scan_cloud: true  # Use point cloud instead of 2D laser scan

    # IMU configuration
    subscribe_imu: false
    imu_topic: "/livox/imu"
    ImuFilter: "1"  # "0"=No filter, "1"=Madgwick, "2"=Complementary

    # Use ICP odometry - ВСЕ значения как строки
    Reg/Strategy: "1"  # "0"=Visual, "1"=ICP, "2"=Visual+ICP
    Reg/Force3DoF: "true"
    Icp/Strategy: "1"  # "0"=PointToPlane, "1"=PointToPoint
    Icp/VoxelSize: "0.02"
    Icp/Iterations: "100"
    Icp/CorrespondenceRatio: "0.05"
    Icp/MaxCorrespondenceDistance: "0.5"
    Icp/OutlierRatio: "0.85"
    Icp/CorrespondenceReduction: "true"
    Icp/PM: "true"  # Probability Mapping
    Icp/PMOutlierRatio: "0.7"

    # RGBD settings
    RGBD/ProximityPathMaxNeighbors: "0"
    
    # Odometry settings
    Odom/Strategy: "1"  # "1" = F2M (Frame-to-Map) ICP
    Odom/F2M/BundleAdjustment: "true"
    Odom/ScanKeyFrameThr: "0.6"
    Odom/F2M/ScanMaxSize: "10000"

    # Map configuration
    Grid/FromDepth: "false"
    Grid/3D: "false"
    Grid/CellSize: "0.02"  # 2cm resolution
    Grid/Size: "15"  # 15m grid size (for 3x3m + margin)
    Grid/RangeMax: "8.0"  # Max lidar range
    Grid/Sensor: "0"
    Grid/MinClusterSize: "3"
    Grid/GlobalUpdated: "true"

    Grid/Global: "true"
    Grid/RayTracing: "true"
    Grid/Updated: "true"

    # Параметры фильтрации облака точек 
    scan_cloud_max_points: 0 # 0=без ограничения, >0=макс. количество точек 
    scan_cloud_min_range: 0.4 # Минимальная дальность 
    scan_cloud_max_range: 10.0 # Максимальная дальность

    # Memory management - ВСЕ как строки
    Mem/ImagePreDecimation: "1"
    Mem/ImagePostDecimation: "1"
    Mem/IncrementalMemory: "true"
    Mem/InitWMWithAllNodes: "false"
    Mem/RehearsalSimilarity: "0.30"
    Mem/NotLinkedNodesKept: "false"

    # Loop closure detection - ВСЕ как строки
    Kp/MaxFeatures: "1000"
    Kp/DetectorStrategy: "6"  # "6"=GFTT
    Vis/MaxFeatures: "1000"
    Vis/FeatureType: "6"  # "6"=GFTT

    # Performance - ВСЕ как строки
    Optimizer/Strategy: "1"  # "1"=g2o
    Optimizer/GravitySigma: "0.3"  # IMU gravity constraint

    # Start with empty map - ВСЕ как строки
    Map/StartAtOrigin: "true"

    # Publishing configuration (обычные ROS параметры)
    publish_tf: true
    publish_tf_map: true
    publish_null_when_lost: false
    publish_map: true
    map_always_visible: true
    grid_map: true
    grid_unknown: true
    map_cleanup: false

    Rtabmap/DetectionRate: "5"
    Rtabmap/TimeThr: "0.2"
